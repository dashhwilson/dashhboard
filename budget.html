
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Budget Management | Digital Dashh</title>
<meta property="og:image" content="http://www.digitaldashh.com/assets/DDBLogo.jpeg" />
<meta property="og:image:width" content="1280" />
<meta property="og:image:height" content="640" />
<meta property="og:type" content="website" />
<meta property="og:title" content="Digital Dashh EventBoard" />
<meta property="og:description" content="A branded command center for event producers. See how Digital Dashh can streamline your entire event workflow." />
  
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Barlow:wght@300;500;700&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: 'Barlow', sans-serif;
      background-color: #f0f4f8;
      color: #1c1c3a;
      margin: 0;
      padding: 0;
    }
    .header {
      background-color: #1c1c3a;
      color: #fff;
      padding: 20px 30px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      flex-wrap: wrap;
    }
    .header h1 {
      margin: 0;
      font-size: 22px;
    }
    .header .right {
      display: flex;
      align-items: center;
      gap: 10px;
    }
    .header a {
      background-color: #ffe066;
      color: #1c1c3a;
      text-decoration: none;
      padding: 6px 14px;
      border-radius: 5px;
      font-weight: bold;
    }
    .header button {
      background-color: #6c79db;
      color: white;
      border: none;
      padding: 8px 16px;
      border-radius: 6px;
      font-weight: bold;
      font-size: 14px;
      cursor: pointer;
    }
    .header button:hover {
      background-color: #5a67d8;
    }
    .menu {
      background-color: #ffffff;
      padding: 10px 30px;
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 10px;
      border-bottom: 1px solid #ddd;
    }
    .menu a {
      background-color: #6c79db;
      color: white;
      text-decoration: none;
      padding: 8px 16px;
      border-radius: 6px;
      font-weight: bold;
    }
    .summary-upload-row {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
      max-width: 1200px;
      margin: 30px auto;
    }
    .grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 20px;
      padding: 30px;
      max-width: 1200px;
      margin: auto;
    }
    .card {
      background-color: #fff;
      border-radius: 12px;
      padding: 16px;
      box-shadow: 0 4px 10px rgba(0,0,0,0.05);
      margin-bottom: 20px;
    }
    .card h3 {
      font-size: 18px;
      margin-top: 0;
      margin-bottom: 12px;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 10px;
    }
    th, td {
      border: 1px solid #ccc;
      padding: 8px;
      font-size: 13px;
    }
    input[type=number], input[type=text] {
      height: 24px !important;
      padding: 4px 6px !important;
      font-size: 13px !important;
      box-sizing: border-box !important;
      line-height: 1.2 !important;
      border-radius: 4px;
      border: 1px solid #ccc;
    }

    td:first-child input[type=text] {
      height: 26px !important;
      padding-top: 5px !important;
      padding-bottom: 5px !important;
      line-height: 1.3 !important;
      display: block;
      width: 100%;
    }

    input {
      height: 22px !important;
      padding: 2px 4px !important;
      font-size: 13px !important;
      box-sizing: border-box !important;
      line-height: 1.2 !important;
      border-radius: 4px;
      border: 1px solid #ccc;
    }
    input {
      height: 34px;
      width: 100%;
      padding: 6px;
      font-family: 'Barlow', sans-serif;
      font-size: 13px;
      border-radius: 4px;
      border: 1px solid #ccc;
    }
    button {
      background-color: #6c79db;
      color: white;
      border: none;
      padding: 8px 14px;
      border-radius: 6px;
      cursor: pointer;
      font-weight: bold;
      margin-top: 10px;
    }
    .remove-btn {
      background-color: #e63946;
    }
    .card img {
      width: 100%;
      max-height: 220px;
      object-fit: contain;
      border-radius: 8px;
    }

.view-toggle-bar {
  display: flex;
  justify-content: center;
  gap: 10px;
  padding: 12px;
  background-color: #e9e9f2;
  border-bottom: 1px solid #ccc;
}

.view-toggle-bar button {
  font-family: 'Barlow', sans-serif;
  padding: 8px 18px;
  border-radius: 8px;
  border: none;
  font-weight: bold;
  cursor: pointer;
  background-color: var(--accent-color);
  color: white;
}

body.production-theme {
  background-color: #eef1fb;
  --accent-color: #8da5e2;
  --text-color: #1c1c3a;
}

body.client-theme {
  background-color: #e9edf3;
  --accent-color: #2c3e50;
  --text-color: #1c1c3a;
}

body.partner-theme {
  background-color: #fdf1f5;
  --accent-color: #f8a9c4;
  --text-color: #1c1c3a;
}

button, .card, .menu a {
  transition: background-color 0.3s ease, color 0.3s ease;
}

body.production-theme .card {
  border-left: 6px solid #8da5e2;
}

body.client-theme .card {
  border-left: 6px solid #2c3e50;
}

body.partner-theme .card {
  border-left: 6px solid #f8a9c4;
}

body.production-theme .menu a,
body.production-theme button {
  background-color: #8da5e2;
}

body.client-theme .menu a,
body.client-theme button {
  background-color: #2c3e50;
}

body.partner-theme .menu a,
body.partner-theme button {
  background-color: #f8a9c4;
}

.partner-only {
  display: none;
}

    /* Highlight active button */
.view-toggle-bar button.active {
  border: 2px solid white;
  box-shadow: 0 0 0 2px var(--accent-color);
}

/* Visibility control for specific sections */
[data-view] {
  display: none;
}

body.production-theme [data-view="production"],
body.client-theme [data-view="client"],
body.partner-theme [data-view="partner"] {
  display: block;
}
    
  </style>
</head>
<body>
  <div class="header">
    <h1>Digital Dashh | Event Dashboard</h1>
    <div class="right">
      <a href="index.html">üè† Home</a>
      <span id="current-date"></span> |
      <span id="countdown"></span>
      <button onclick="logout()">Logout</button>
    </div>
  </div>

  <div class="menu">
    <a href="overview.html">Overview</a>
    <a href="budget.html">Budget</a>
    <a href="venues.html">Venues</a>
    <a href="av.html">AV Production</a>
    <a href="content.html">Creative Content</a>
    <a href="sponsor-tracker.html">Sponsor Tracker</a>
    <a href="merch-inventory.html">Merch Inventory</a>
  </div>

  <div class="view-toggle-bar">
    <button onclick="setView('production')" id="btn-production">Production View</button>
    <button onclick="setView('client')" id="btn-client">Client View</button>
    <button onclick="setView('partner')" class="partner-only" id="btn-partner">Partner View</button>
  </div>
  
  <div class="summary-upload-row">
    <div class="card">
      <h3>üìä Budget Summary</h3>
   <form id="budgetForm">
  <label for="totalBudget">Total Budget ($):</label>
  <input type="number" id="totalBudget" name="totalBudget" placeholder="Enter total budget" />
  <button type="submit">üíæ Save Budget</button>
</form>
<p><strong>Total Budget:</strong> <span id="displayTotal">Loading...</span></p>
      <p><strong>Spent to Date:</strong> <span id="spentToDate">Loading...</span></p>
    
    </div>
    <div class="card">
      <h3>üì§ Upload Budget Sheet</h3>
      <p><a href="https://docs.google.com/spreadsheets/d/1kYv-template-link" target="_blank">üì• Open Google Sheet Template</a></p>
      <style>
        .upload-flex {
          display: flex;
          align-items: center;
          gap: 10px;
          margin-top: 8px;
        }
        .upload-button {
          background-color: #6c79db;
          color: white;
          padding: 8px 14px;
          border: none;
          border-radius: 6px;
          font-size: 14px;
          font-family: 'Barlow', sans-serif;
          font-weight: bold;
          cursor: pointer;
          display: inline-flex;
          align-items: center;
        }
        input[type="file"] {
          display: none;
        }
        .file-label {
          background-color: #6c79db;
          color: white;
          padding: 8px 14px;
          border-radius: 6px;
          cursor: pointer;
          font-family: 'Barlow', sans-serif;
          font-size: 14px;
          font-weight: bold;
          display: inline-block;
        }
        #fileName {
          font-size: 13px;
          font-family: 'Barlow', sans-serif;
          color: #1c1c3a;
        }
      </style>
      <div class="upload-flex">
        <label for="budgetFileInput" class="file-label">üìÅ Choose File</label>
        <input type="file" id="budgetFileInput">
        <span id="fileName">No file selected</span>
        <button class="upload-button">Upload Budget File</button>
      </div>
      <script>
        document.getElementById("budgetFileInput").addEventListener("change", function() {
          const name = this.files.length > 0 ? this.files[0].name : "No file selected";
          document.getElementById("fileName").textContent = name;
        });
      </script>
    </div>
  </div>

  <div class="card">
    <h3>üóÇÔ∏è Category Breakdown</h3>
    <div style="margin-bottom: 10px;">
      <button onclick="addRow()">‚ûï Add Row</button>
      <button onclick="exportCSV()">üì§ Export CSV</button>
    </div>
    <table id="budgetTable">
      <thead>
        <tr>
          <th>Category</th>
          <th>Budgeted</th>
          <th>Actual</th>
          <th>Remaining</th>
          <th>Action</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td><input value="Venue"></td>
          <td><input type="number" value="15000" class="budgeted"></td>
          <td><input type="number" value="12000" class="actual"></td>
          <td class="remaining"></td>
          <td><button class="remove-btn" onclick="removeRow(this)">Remove</button></td>
        </tr>
        <tr>
          <td><input value="Catering"></td>
          <td><input type="number" value="10000" class="budgeted"></td>
          <td><input type="number" value="7500" class="actual"></td>
          <td class="remaining"></td>
          <td><button class="remove-btn" onclick="removeRow(this)">Remove</button></td>
        </tr>
        <tr>
          <td><input value="Travel"></td>
          <td><input type="number" value="5000" class="budgeted"></td>
          <td><input type="number" value="5500" class="actual"></td>
          <td class="remaining"></td>
          <td><button class="remove-btn" onclick="removeRow(this)">Remove</button></td>
        </tr>
      </tbody>
    </table>
    <canvas id="budgetChart" height="150" style="margin-top: 30px;"></canvas>
  </div>
<div class="card" data-view="production">
  <h3>Internal Notes for Production Team</h3>
  <p>These are only visible in Production view.</p>
</div>

<div class="card" data-view="client">
  <h3>Client-Only Overview</h3>
  <p>This card is visible only in Client view.</p>
</div>

<div class="card" data-view="partner">
  <h3>Partner-Specific Details</h3>
  <p>This content shows only in Partner view.</p>
</div>
  <div class="grid">
    <div class="card">
      <h3>üìà Expense Breakdown</h3>
      <img src="https://static.wixstatic.com/media/8267b6_6da8bd52ce7646e397d5eb147828605c~mv2.png" alt="Expense Breakdown Pie Chart" />
    </div>
    <div class="card">
  <h3>üö® Flagged Overages</h3>
  <ul id="overagesList">
    <!-- Overages will populate here dynamically -->
  </ul>
</div>
  </div>

 <script>
  // Set current date and countdown
  const today = new Date();
  const dateString = today.toLocaleDateString(undefined, { weekday: 'long', year: 'numeric', month: 'short', day: 'numeric' });
  document.getElementById('current-date').textContent = dateString;

  const eventDate = new Date('2025-06-30T00:00:00');
  const diff = eventDate - today;
  const daysLeft = Math.ceil(diff / (1000 * 60 * 60 * 24));
  document.getElementById('countdown').textContent = `${daysLeft} days until event`;

  // Chart setup
  const ctx = document.getElementById("budgetChart").getContext("2d");
  const budgetChart = new Chart(ctx, {
    type: "bar",
    data: {
      labels: [],
      datasets: [
        { label: "Budgeted", backgroundColor: "#6c79db", data: [] },
        { label: "Actual", backgroundColor: "#ffe066", data: [] }
      ]
    },
    options: {
      responsive: true,
      plugins: {
        legend: { position: 'top' },
        title: { display: true, text: 'Category Spend vs Budget' }
      }
    }
  });

  // Update chart, remaining, and flagged overages
  function updateChartAndTable() {
    const rows = document.querySelectorAll("#budgetTable tbody tr");
    const labels = [], budgeted = [], actual = [];

    const overagesList = document.getElementById("overagesList");
    overagesList.innerHTML = ""; // Clear old overages

    rows.forEach(row => {
      const category = row.querySelector("td:nth-child(1) input").value;
      const budInput = row.querySelector(".budgeted");
      const actInput = row.querySelector(".actual");

      const bud = parseFloat(budInput?.value) || 0;
      const act = parseFloat(actInput?.value) || 0;
      const remaining = bud - act;

      row.querySelector(".remaining").textContent = "$" + remaining.toLocaleString();
      row.querySelector(".remaining").style.color = remaining < 0 ? "red" : "#1c1c3a";

      labels.push(category);
      budgeted.push(bud);
      actual.push(act);

      if (act > bud) {
        const over = (act - bud).toLocaleString("en-US", { style: "currency", currency: "USD" });
        const li = document.createElement("li");
        li.textContent = `‚ö†Ô∏è ${category} ‚Äì Actual exceeds budget by ${over}`;
        overagesList.appendChild(li);
      }
    });

    budgetChart.data.labels = labels;
    budgetChart.data.datasets[0].data = budgeted;
    budgetChart.data.datasets[1].data = actual;
    budgetChart.update();
  }

  function addRow() {
    const table = document.querySelector("#budgetTable tbody");
    const row = document.createElement("tr");
    row.innerHTML = `
      <td><input value="New Category"></td>
      <td><input type="number" class="budgeted" value="0"></td>
      <td><input type="number" class="actual" value="0"></td>
      <td class="remaining"></td>
      <td><button class="remove-btn" onclick="removeRow(this)">Remove</button></td>
    `;
    table.appendChild(row);
    attachListeners(row);
    updateChartAndTable();
  }

  function removeRow(button) {
    button.closest("tr").remove();
    updateChartAndTable();
  }

  function exportCSV() {
    let csv = "Category,Budgeted,Actual,Remaining\n";
    document.querySelectorAll("#budgetTable tbody tr").forEach(row => {
      const category = row.querySelector("td:nth-child(1) input").value;
      const budget = row.querySelector("td:nth-child(2) input").value;
      const act = row.querySelector("td:nth-child(3) input").value;
      const remaining = row.querySelector(".remaining").textContent;
      csv += `${category},${budget},${act},${remaining}\n`;
    });

    const blob = new Blob([csv], { type: "text/csv" });
    const url = URL.createObjectURL(blob);
    const link = document.createElement("a");
    link.href = url;
    link.download = "category_breakdown.csv";
    link.click();
    URL.revokeObjectURL(url);
  }

  function attachListeners(row) {
    row.querySelector(".budgeted").addEventListener("input", updateChartAndTable);
    row.querySelector(".actual").addEventListener("input", updateChartAndTable);
  }

  // Attach listeners to initial rows
  document.querySelectorAll("#budgetTable tbody tr").forEach(attachListeners);
  updateChartAndTable();
</script>

<script>
  function setView(view) {
    const body = document.body;
    const views = ['production', 'client', 'partner'];

    // Theme class
    views.forEach(v => body.classList.remove(`${v}-theme`));
    body.classList.add(`${view}-theme`);

    // Save preference
    localStorage.setItem('dashhboardView', view);

    // Update active button
    views.forEach(v => {
      const btn = document.getElementById(`btn-${v}`);
      if (btn) btn.classList.remove('active');
    });
    const activeBtn = document.getElementById(`btn-${view}`);
    if (activeBtn) activeBtn.classList.add('active');
  }

  document.addEventListener("DOMContentLoaded", function () {
    const savedView = localStorage.getItem('dashhboardView') || 'production';
    setView(savedView);

    const isBudget = window.location.pathname.includes('budget.html');
    if (isBudget) {
      document.querySelectorAll('.partner-only').forEach(el => el.style.display = 'none');
    }
  });
</script>
  <!-- Firebase SDKs -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>

  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyCfgmw0XlHj3BY9A-CS1-u_n4TDUuTNqmM",
      authDomain: "digital-dashh.firebaseapp.com",
      projectId: "digital-dashh",
      storageBucket: "digital-dashh.appspot.com",
      messagingSenderId: "535613848097",
      appId: "1:535613848097:web:bcd4a58bf1bd9497e48160"
    };

    firebase.initializeApp(firebaseConfig);
  const auth = firebase.auth();
const db = firebase.database();
  </script>

  <script>
  firebase.auth().onAuthStateChanged(function(user) {
    if (!user) {
      // User not logged in, redirect to login page
      window.location.href = "login.html";
    }
  });
</script>
<script>
  document.addEventListener("DOMContentLoaded", function () {
    const totalBudgetInput = document.getElementById('totalBudget');
    const budgetForm = document.getElementById('budgetForm');
    const displayTotal = document.getElementById('displayTotal');
    const budgetPath = 'projects/digital-dashh/budget';
    const budgetRef = db.ref(`${budgetPath}/total`);

    budgetRef.on('value', (snapshot) => {
      const total = snapshot.val();
      if (total !== null) {
        displayTotal.textContent = `$${parseFloat(total).toLocaleString()}`;
        totalBudgetInput.value = total;
      } else {
        displayTotal.textContent = 'Not set';
      }
    });

    budgetForm.addEventListener('submit', function(e) {
      e.preventDefault();
      const newTotal = parseFloat(totalBudgetInput.value);
      if (!isNaN(newTotal)) {
        db.ref(`${budgetPath}/total`).set(newTotal)
          .then(() => {
            alert("‚úÖ Total budget saved!");
            displayTotal.textContent = `$${newTotal.toLocaleString()}`;
          })
          .catch(err => console.error("Save error:", err));
      }
    });
  });
</script>
<script>
  document.addEventListener("DOMContentLoaded", function () {
    const totalBudgetInput = document.getElementById('totalBudget');
    const budgetForm = document.getElementById('budgetForm');
    const displayTotal = document.getElementById('displayTotal');
    const displaySpent = document.getElementById('spentToDate');
    const budgetPath = 'projects/digital-dashh/budget';
    const budgetRef = db.ref(`${budgetPath}/total`);

    // Load saved total budget from Firebase
    budgetRef.on('value', (snapshot) => {
      const total = snapshot.val();
      if (total !== null) {
        displayTotal.textContent = `$${parseFloat(total).toLocaleString()}`;
        totalBudgetInput.value = total;
      } else {
        displayTotal.textContent = 'Not set';
      }
    });

    // Save total budget to Firebase
    budgetForm.addEventListener('submit', function(e) {
      e.preventDefault();
      const newTotal = parseFloat(totalBudgetInput.value);
      if (!isNaN(newTotal)) {
        db.ref(`${budgetPath}/total`).set(newTotal)
          .then(() => {
            alert("‚úÖ Total budget saved!");
            displayTotal.textContent = `$${newTotal.toLocaleString()}`;
          })
          .catch(err => console.error("Save error:", err));
      }
    });

    // Calculate and display Spent to Date
    function updateSpentToDate() {
      let sum = 0;
      document.querySelectorAll(".actual").forEach(input => {
        const value = parseFloat(input.value);
        if (!isNaN(value)) sum += value;
      });
      displaySpent.textContent = `$${sum.toLocaleString()}`;
    }

    updateSpentToDate();
    document.querySelectorAll(".actual").forEach(input => {
      input.addEventListener("input", updateSpentToDate);
    });
  });
</script>

  
</body>
</html>
