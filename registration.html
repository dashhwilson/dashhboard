<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Registration | Digital Dashh</title>
  <link href="https://fonts.googleapis.com/css2?family=Barlow:wght@300;500;700&display=swap" rel="stylesheet">
  <style>
    body { font-family: 'Barlow', sans-serif; background-color: #f0f4f8; margin: 0; padding: 0; color: #1c1c3a; }
    .header { background-color: #1c1c3a; color: white; text-align: center; padding: 20px; font-size: 24px; font-weight: bold; }
    .menu { background-color: #ffe066; display: flex; flex-wrap: wrap; justify-content: center; gap: 10px; padding: 12px; }
    .menu a { background-color: #6c79db; color: white; padding: 8px 16px; border-radius: 6px; font-weight: bold; text-decoration: none; }
    .grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; padding: 30px; max-width: 1200px; margin: auto; }
    .card { background-color: white; border-radius: 12px; padding: 20px; box-shadow: 0 4px 10px rgba(0,0,0,0.05); }
    table { width: 100%; border-collapse: collapse; margin-top: 10px; }
    th, td { border: 1px solid #ccc; padding: 10px 12px; font-size: 14px; text-align: left; }
    th { background-color: #f4f4f4; }
    tr:hover { background-color: #f1f7ff; }
    .tag { background-color: #e0ecf8; padding: 2px 8px; border-radius: 8px; font-size: 12px; }
    .small-btn { background-color: #6c79db; color: white; border: none; padding: 6px 10px; border-radius: 20px; font-size: 12px; cursor: pointer; margin: 2px; transition: all 0.3s ease; }
    .small-btn:hover { background-color: #5a67d8; }
    button { font-family: 'Barlow', sans-serif; }
    input, select { margin-top: 4px; margin-bottom: 6px; width: 100%; padding: 6px; font-size: 14px; border-radius: 6px; border: 1px solid #ccc; }
    .progress-bar { width: 100%; height: 12px; background-color: #eee; border-radius: 8px; overflow: hidden; margin: 8px 0 12px; }
    .progress-bar-fill { height: 100%; background-color: #6c79db; width: 0%; transition: width 0.4s ease; }
  </style>
</head>
<body>

<div class="header">Digital Dashh | Registration</div>

<div class="menu">
  <a href="overview.html">Overview</a>
  <a href="budget.html">Budget</a>
  <a href="venues.html">Venues</a>
  <a href="av.html">AV Production</a>
  <a href="content.html">Creative Content</a>
  <a href="sponsor-tracker.html">Sponsor Tracker</a>
  <a href="merch-inventory.html">Merch Inventory</a>
</div>

<div class="grid">

  <div class="card">
    <h3>üìà Registration Summary</h3>
    <p id="totalReg">Total Registered: 0</p>
    <p id="capacity">Capacity: 500</p>
    <p id="checkedIn">Checked In: 0</p>
    <p id="remaining">Remaining: 0</p>
    <hr class="divider">
    <p id="percentFilled">Capacity Filled: 0%</p>
    <div class="progress-bar"><div id="progressFill" class="progress-bar-fill"></div></div>
    <p id="vipGeneralBreakdown">VIPs: 0 | Panelists: 0 | General: 0</p>
    <p id="statusBreakdown">Confirmed: 0 | Pending: 0</p>
    <button onclick="downloadCSV()">üì• Download CSV</button>
  </div>

  <div class="card" style="grid-column: span 2;">
    <h3>üØû Attendee List</h3>
    <table>
      <thead>
        <tr><th>Name</th><th>Email</th><th>Type</th><th>Status</th><th>Actions</th></tr>
      </thead>
      <tbody id="attendeeTable"></tbody>
    </table>
    <button onclick="addAttendee()">‚ûï Add Attendee</button>
  </div>

  <div class="card" style="grid-column: span 2;">
    <h3>üçΩÔ∏è Lodging, Food & Beverage Details</h3>
    <table>
      <thead>
        <tr><th>Name</th><th>Allergies</th><th>Milk Preference</th><th>Hotel Needed?</th></tr>
      </thead>
      <tbody id="fnbTable"></tbody>
    </table>
  </div>

</div>

<script>
  let attendees = [
    { name: "Jordan Smith", email: "jordan@example.com", type: "VIP", status: "Confirmed" },
    { name: "Taylor Gray", email: "taylor@example.com", type: "Panelist", status: "Pending" }
  ];
  let fnbPrefs = [
    { name: "Jordan Smith", allergies: "None", milk: "Oat", hotel: "Yes" },
    { name: "Taylor Gray", allergies: "Peanuts", milk: "Whole", hotel: "No" }
  ];

  let editingRow = null;

  function renderTables() {
    const attendeeTable = document.getElementById('attendeeTable');
    const fnbTable = document.getElementById('fnbTable');
    attendeeTable.innerHTML = '';
    fnbTable.innerHTML = '';

    let vipCount = 0, panelistCount = 0, generalCount = 0;
    let confirmedCount = 0, pendingCount = 0;

    attendees.forEach((attendee, index) => {
      if (editingRow === index) {
        attendeeTable.innerHTML += `
          <tr>
            <td><input value="${attendee.name}" id="editName${index}"></td>
            <td><input value="${attendee.email}" id="editEmail${index}"></td>
            <td>
              <select id="editType${index}">
                <option ${attendee.type==="VIP"?"selected":""}>VIP</option>
                <option ${attendee.type==="Panelist"?"selected":""}>Panelist</option>
                <option ${attendee.type==="General"?"selected":""}>General</option>
              </select>
            </td>
            <td>
              <select id="editStatus${index}">
                <option ${attendee.status==="Confirmed"?"selected":""}>Confirmed</option>
                <option ${attendee.status==="Pending"?"selected":""}>Pending</option>
              </select>
            </td>
            <td>
              <button class="small-btn" onclick="saveEdit(${index})">üíæ Save</button>
              <button class="small-btn" onclick="cancelEdit()">‚ùå Cancel</button>
            </td>
          </tr>
        `;
      } else {
        attendeeTable.innerHTML += `
          <tr>
            <td>${attendee.name}</td>
            <td>${attendee.email}</td>
            <td>${attendee.type}</td>
            <td><span class="tag">${attendee.status}</span></td>
            <td>
              <button class="small-btn" onclick="startEdit(${index})">‚úèÔ∏è Edit</button>
              <button class="small-btn" onclick="removeAttendee(${index})">üóëÔ∏è Remove</button>
            </td>
          </tr>
        `;
      }

      if (attendee.type.toLowerCase() === "vip") vipCount++;
      else if (attendee.type.toLowerCase() === "panelist") panelistCount++;
      else generalCount++;

      if (attendee.status.toLowerCase() === "confirmed") confirmedCount++;
      else pendingCount++;
    });

    fnbPrefs.forEach((pref, idx) => {
      fnbTable.innerHTML += `
        <tr>
          <td>${pref.name}</td>
          <td><input type="text" value="${pref.allergies}" onchange="updateFnb(${idx}, 'allergies', this.value)"></td>
          <td><input type="text" value="${pref.milk}" onchange="updateFnb(${idx}, 'milk', this.value)"></td>
          <td>
            <select onchange="updateFnb(${idx}, 'hotel', this.value)">
              <option ${pref.hotel==="Yes"?"selected":""}>Yes</option>
              <option ${pref.hotel==="No"?"selected":""}>No</option>
            </select>
          </td>
        </tr>
      `;
    });

    const capacity = 500;
    const percentFilled = capacity > 0 ? Math.round((attendees.length / capacity) * 100) : 0;
    document.getElementById('progressFill').style.width = `${percentFilled}%`;

    document.getElementById('totalReg').textContent = `Total Registered: ${attendees.length}`;
    document.getElementById('capacity').textContent = `Capacity: ${capacity}`;
    document.getElementById('checkedIn').textContent = `Checked In: 1`;
    document.getElementById('remaining').textContent = `Remaining: ${capacity - attendees.length}`;
    document.getElementById('percentFilled').textContent = `Capacity Filled: ${percentFilled}%`;
    document.getElementById('vipGeneralBreakdown').textContent = `VIPs: ${vipCount} | Panelists: ${panelistCount} | General: ${generalCount}`;
    document.getElementById('statusBreakdown').textContent = `Confirmed: ${confirmedCount} | Pending: ${pendingCount}`;
  }

  function addAttendee() {
    const name = prompt("Enter name:");
    const email = prompt("Enter email:");
    const type = prompt("Enter type (VIP/Panelist/General):");
    const status = prompt("Enter status (Confirmed/Pending):");
    if (name && email && type && status) {
      attendees.push({ name, email, type, status });
      fnbPrefs.push({ name, allergies: "", milk: "", hotel: "No" });
      renderTables();
    }
  }

  function removeAttendee(index) {
    attendees.splice(index, 1);
    fnbPrefs.splice(index, 1);
    editingRow = null;
    renderTables();
  }

  function startEdit(index) {
    editingRow = index;
    renderTables();
  }

  function cancelEdit() {
    editingRow = null;
    renderTables();
  }

  function saveEdit(index) {
    attendees[index].name = document.getElementById(`editName${index}`).value;
    attendees[index].email = document.getElementById(`editEmail${index}`).value;
    attendees[index].type = document.getElementById(`editType${index}`).value;
    attendees[index].status = document.getElementById(`editStatus${index}`).value;
    editingRow = null;
    renderTables();
  }

  function updateFnb(index, field, value) {
    fnbPrefs[index][field] = value;
  }

  function downloadCSV() {
    let csv = "Name,Email,Type,Status\n";
    attendees.forEach(a => { csv += `${a.name},${a.email},${a.type},${a.status}\n`; });
    const blob = new Blob([csv], { type: 'text/csv' });
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = "attendees.csv";
    document.body.appendChild(a);
    a.click();
    document.body.removeChild(a);
  }

  renderTables();
</script>

</body>
</html>
